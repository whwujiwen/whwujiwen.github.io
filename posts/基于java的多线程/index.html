<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="theme-color" content="#000" />
    <title>
        
            Java多线程基础知识 &middot; Blog Hugo Theme - Prav
        
    </title>

    
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css"
        integrity="sha384-nn4HPE8lTHyVtfCBi5yW9d20FjT8BJwUXyWZT9InLYax14RDjBj46LmSztkmNP9w" crossorigin="anonymous">
    
    
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/grids-responsive-min.css">
    
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Merriweather:300,300italic,700&display=swap" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans+Condensed:300&display=swap" rel="stylesheet">
    <link rel="icon" href="/img/favicon.ico" type="image/x-icon">

    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="">
    
    <meta name="description" content="一种提高程序运行效率的技术">
    
    <meta name="keywords" content="编程">
    
    <meta name="author" content="吴继文"></head>

<body>
        <div class="container">
<div id="navbar" class="pure-menu pure-menu-open pure-menu-horizontal pure-menu-scrollable">
    <a href="/" class="pure-menu-heading">
         
            Blog 
         
    </a>
    <ul class="pure-menu-list">
        <li class="pure-menu-item">
            <a href="/posts" class="pure-menu-link">
                <i class="fa fa-archive"></i>
                文章
            </a>
        </li>
        <li class="pure-menu-item">
            <a href="/tags" class="pure-menu-link">
                <i class="fas fa-comments"></i>
                分类
            </a>
        </li>
        <li class="pure-menu-item">
            <a href="/about" class="pure-menu-link">
                <i class="fas fa-smile"></i>
                关于我
            </a>
        </li>
    </ul>
    <ul class="pure-menu-list pull-right">
        
        <li class="pure-menu-item">
            <a href="https://www.baidu.com" title="Github" class="pure-menu-link">
                <i class="fab fa-github"></i>
                <span class="hide">Github</span>
            </a>
        </li>
        
        
        <li class="pure-menu-item">
            <a href="http://twitter.com/example" title="@pravin" class="pure-menu-link">
                <i class="fab fa-twitter-square"></i>
                <span class="hide">Twitter</span>
            </a>
        </li>
        
        
        <li class="pure-menu-item">
            <a href="http://uk.linkedin.com/in/example" title="Linked In" class="pure-menu-link">
                <i class="fab fa-linkedin"></i>
                <span class="hide">LinkedIn</span>
            </a>
        </li>
        
        
        <li class="pure-menu-item">
            <a href="https://www.medium.com/@example" title="Medium" class="pure-menu-link">
                <i class="fab fa-medium"></i>
                <span class="hide">Medium</span>
            </a>
        </li>
        
        
        <li class="pure-menu-item">
            <a href="https://www.facebook.com/example" title="Facebook" class="pure-menu-link">
                <i class="fab fa-facebook"></i>
                <span class="hide">Facebook</span>
            </a>
        </li>
        
        <li class="pure-menu-item">
            <a href="/atom.xml" title="Atom Feed" class="pure-menu-link">
                <i class="fas fa-rss-square"></i>
                <span class="hide">RSS Feed</span>
            </a>
        </li>
    </ul>
</div>
<div class="pure-u-1">
    <div class="pad">
    </div>
</div>
<div class="pure-g">


<div id="content" class="pure-u-1 pure-u-md-3-4 pure-u-sm-1">
    <div class="pad">

<div class="date">
    <time pubdate="0001-01-01">January 1, 0001</time>
    <span class="author">学习笔记</span>
</div>

<article>
    <h1><a href="https://example.com/posts/%E5%9F%BA%E4%BA%8Ejava%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B/">Java多线程基础知识</a></h1>
    <div class="tags">
        
        
        <a href="/tags/%E7%BC%96%E7%A8%8B" class="pure-button">编程</a>
        
    </div>
    <h2 id="一进程与线程">一、进程与线程</h2>
<blockquote>
<p>进程：一个程序运行所占用的各种资源的描述。
线程：一个进程中任务执行任务的具体单元。
一个进程可以包含多个线程，若一个进程中没有线程，那么表示该进程已经执行完毕。进程可以实现多个任务的并发执行(时间片)。
存在的弊端：多进程无法实现资源的共享。</p>
</blockquote>
<h2 id="二进程的生命周期">二、进程的生命周期</h2>
<p>在程序的开发过程中，将一个进程被实例化完成，到这个线程使用结束，并销毁的过程，称为进程的生命周期。</p>
<h2 id="三线程的状态">三、线程的状态</h2>
<p>新生态(New):一个线程被实例化完成(在执行start之前的状态)，但是没有任何操作。
就绪态(rReady):一个线程已经被开启，并且已经开始争抢CPU时间片
运行态(run):线程已经抢到时间片，开始执行业务逻辑了。
阻塞态(Interrupt):线程运行的过程中，受到某些外界因素的影响，放弃得到的CPU时间片，并不在参与争夺CPU时间片。(挂起状态)
死亡态(Dead):想成被销毁。
线程的生命周期：
<img src="/assets/blogImg/thread.png" alt="opencv"></p>
<h2 id="四线程的开辟方式">四、线程的开辟方式</h2>
<p>1.继承Thread，做一个线程子类(自定义线程类)</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">com.mntc.thread</span>;

<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">MyThread</span> {
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
		ThreadCreat tc = <span style="color:#8b008b;font-weight:bold">new</span> ThreadCreat();
		tc.<span style="color:#658b00">start</span>();
		<span style="color:#8b008b;font-weight:bold">for</span>(<span style="color:#00688b;font-weight:bold">int</span> i=0;i&lt;10;i++) {
			System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;主线程中逻辑:&#34;</span>+i);
		}
	}
}
<span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">ThreadCreat</span> <span style="color:#8b008b;font-weight:bold">extends</span> Thread{
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">run</span>() {
		<span style="color:#8b008b;font-weight:bold">for</span>(<span style="color:#00688b;font-weight:bold">int</span> i=0;i&lt;10;i++) {
			System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;子线程中逻辑:&#34;</span>+i);
		}
	}
}
</code></pre></div><p>2.通过继承Runnable接口</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Runnable r1 =()-&gt;{
    <span style="color:#8b008b;font-weight:bold">for</span>(<span style="color:#00688b;font-weight:bold">int</span> i=0;i&lt;10;i++) {
        System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;Runnable线程中逻辑:&#34;</span>+i);
    }
};

Thread t1 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1);

t1.<span style="color:#658b00">start</span>();
</code></pre></div><h2 id="五线程的命名">五、线程的命名</h2>
<p>方式一：
Thread t = new Thread(&ldquo;custom&rdquo;);
方式二：
Thread t =  new Thread();
t.setName(&ldquo;custom&rdquo;);</p>
<h2 id="六线程的休眠">六、线程的休眠</h2>
<p>Thread.sleep(1000);//设置线程休眠的时间为1秒
分析：线程的休眠实际是使线程处于一种阻塞的状体。
传入其中的参数的单位使毫秒。</p>
<h2 id="七线程的优先级">七、线程的优先级</h2>
<p>1.设置线程的优先级知识修改这个线程抢到时间片的概率
2.并不是优先级高的一定能抢到CPU时间片
3.优先级的设置是[0，10]的整数，默认是5
4.设置优先级必须放在线程执行start()之前
案例：</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">t1.<span style="color:#658b00">setPriority</span>(4);
</code></pre></div><h2 id="八线程的礼让">八、线程的礼让</h2>
<p>线程的礼让:指的是让当前的运行状态的线程释放自己的CPU资源，由运行状态，回到就绪状态。
注意：当线程A与线程B争抢资源时，线程A争抢到时间片并进行礼让，并不意味着让B去执行线程，而是让线程A与线程B重新去争夺CPU时间片。
线程礼让的的语法：</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Thread.<span style="color:#658b00">yield</span>();
</code></pre></div><p>另外获取当前线程名的基本语法为：</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">Thread.<span style="color:#658b00">currentThread</span>().<span style="color:#658b00">getName</span>();
</code></pre></div><h2 id="九线程中临界资源">九、线程中临界资源</h2>
<p>临界资源：被多个线程共享的资源称之为临界资源。
临界资源存在的问题：</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">com.mntc.thread</span>;
<span style="color:#228b22">//临界资源问题
</span><span style="color:#228b22"></span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">MyThread</span> {
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
	Runnable r1 =()-&gt;{
        <span style="color:#8b008b;font-weight:bold">synchronized</span>(){
            <span style="color:#8b008b;font-weight:bold">while</span>(ThreadCreat.<span style="color:#658b00">ticketCount</span>&gt;=0) {
                System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(Thread.<span style="color:#658b00">currentThread</span>().<span style="color:#658b00">getName</span>()+<span style="color:#cd5555">&#34;:剩余的票数为&#34;</span>+ --ThreadCreat.<span style="color:#658b00">ticketCount</span> + <span style="color:#cd5555">&#34;张&#34;</span>);
            }
        }
	};
    <span style="color:#228b22">//四个线程模拟四个售票员，四个线程的名字模拟四个售票员的名字
</span><span style="color:#228b22"></span>	Thread t1 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1,<span style="color:#cd5555">&#34;Thread-1&#34;</span>);
	Thread t2 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1,<span style="color:#cd5555">&#34;Thread-2&#34;</span>);
	Thread t3 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1,<span style="color:#cd5555">&#34;Thread-3&#34;</span>);
	Thread t4 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1,<span style="color:#cd5555">&#34;Thread-4&#34;</span>);
	t1.<span style="color:#658b00">start</span>();
	t2.<span style="color:#658b00">start</span>();
	t3.<span style="color:#658b00">start</span>();
	t4.<span style="color:#658b00">start</span>();
	}
}
<span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">ThreadCreat</span>{
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">int</span> ticketCount=100;
}
<span style="color:#a61717;background-color:#e3d2d2">```</span>十<span style="color:#a61717;background-color:#e3d2d2">、</span>锁
基于上述临界资源的问题<span style="color:#a61717;background-color:#e3d2d2">，</span>需要引入锁的相关概念<span style="color:#a61717;background-color:#e3d2d2">。</span>
<span style="color:#a61717;background-color:#e3d2d2">```</span> java
<span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">com.mntc.thread</span>;
<span style="color:#228b22">//临界资源问题
</span><span style="color:#228b22"></span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">MyThread</span> {
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
	Runnable r1 =()-&gt;{
        <span style="color:#8b008b;font-weight:bold">while</span>(ThreadCreat.<span style="color:#658b00">ticketCount</span>&gt;=0) {
        	<span style="color:#228b22">//对象锁
</span><span style="color:#228b22"></span>        	<span style="color:#228b22">//类锁
</span><span style="color:#228b22"></span>        	<span style="color:#228b22">//无论是对象锁，还是类锁，必须保证的是加的十同一把锁
</span><span style="color:#228b22"></span>        	<span style="color:#8b008b;font-weight:bold">synchronized</span>(MyThread.<span style="color:#658b00">class</span>){
        		<span style="color:#8b008b;font-weight:bold">if</span>(ThreadCreat.<span style="color:#658b00">ticketCount</span>&lt;=0){
        			<span style="color:#8b008b;font-weight:bold">return</span>;
        		}
        		System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(Thread.<span style="color:#658b00">currentThread</span>().<span style="color:#658b00">getName</span>()+<span style="color:#cd5555">&#34;:剩余的票数为&#34;</span>+ --ThreadCreat.<span style="color:#658b00">ticketCount</span> + <span style="color:#cd5555">&#34;张&#34;</span>);
        	}
        }
	};
	
	Thread t1 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1,<span style="color:#cd5555">&#34;Thread-1&#34;</span>);
	Thread t2 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1,<span style="color:#cd5555">&#34;Thread-2&#34;</span>);
	Thread t3 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1,<span style="color:#cd5555">&#34;Thread-3&#34;</span>);
	Thread t4 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1,<span style="color:#cd5555">&#34;Thread-4&#34;</span>);
	t1.<span style="color:#658b00">start</span>();
	t2.<span style="color:#658b00">start</span>();
	t3.<span style="color:#658b00">start</span>();
	t4.<span style="color:#658b00">start</span>();
	}
	
}
<span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">ThreadCreat</span>{
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">int</span> ticketCount=100;
	
}
</code></pre></div><h2 id="十一显示锁">十一、显示锁</h2>
<p>就是在调用临界资源之前我们进行上锁，使用完成之后我们再进行解锁。当然我们还可以通过同步方法的方式来实现(这里我们就不对这种方式进行说明)</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">com.mntc.thread</span>;

<span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.util.concurrent.locks.ReentrantLock</span>;

<span style="color:#228b22">//临界资源问题
</span><span style="color:#228b22"></span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">MyThread</span> {
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
		  <span style="color:#228b22">//实例化一个锁对象
</span><span style="color:#228b22"></span>	    ReentrantLock lock = <span style="color:#8b008b;font-weight:bold">new</span> ReentrantLock();
		Runnable r1 =()-&gt;{
	        <span style="color:#8b008b;font-weight:bold">while</span>(ThreadCreat.<span style="color:#658b00">ticketCount</span>&gt;=0) {
	        	<span style="color:#228b22">//对象锁
</span><span style="color:#228b22"></span>	        	<span style="color:#228b22">//类锁
</span><span style="color:#228b22"></span>	        	<span style="color:#228b22">//无论是对象锁，还是类锁，必须保证的十加的十同一把锁
</span><span style="color:#228b22"></span>	        	lock.<span style="color:#658b00">lock</span>();
		        	<span style="color:#8b008b;font-weight:bold">if</span>(ThreadCreat.<span style="color:#658b00">ticketCount</span>&lt;=0){
	        			<span style="color:#8b008b;font-weight:bold">return</span>;
	        		}
	        		System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(Thread.<span style="color:#658b00">currentThread</span>().<span style="color:#658b00">getName</span>()+<span style="color:#cd5555">&#34;:剩余的票数为&#34;</span>+ --ThreadCreat.<span style="color:#658b00">ticketCount</span> + <span style="color:#cd5555">&#34;张&#34;</span>);
	        	lock.<span style="color:#658b00">unlock</span>();
	        	}
	        
		};
	
	Thread t1 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1,<span style="color:#cd5555">&#34;Thread-1&#34;</span>);
	Thread t2 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1,<span style="color:#cd5555">&#34;Thread-2&#34;</span>);
	Thread t3 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1,<span style="color:#cd5555">&#34;Thread-3&#34;</span>);
	Thread t4 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1,<span style="color:#cd5555">&#34;Thread-4&#34;</span>);
	t1.<span style="color:#658b00">start</span>();
	t2.<span style="color:#658b00">start</span>();
	t3.<span style="color:#658b00">start</span>();
	t4.<span style="color:#658b00">start</span>();
	}
	
}
<span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">ThreadCreat</span>{
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">int</span> ticketCount=100;
	
}
</code></pre></div><h2 id="十二死锁">十二、死锁</h2>
<p>死锁：多个线程彼此持有对方所需要的锁对象，而不释放自己的锁。
说明：线程A持有线程B的锁对象，线程B持有线程A的锁对象，并且线程A和线程B都不释放他们持有的所对象。
程序说明:</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">com.mntc.dead</span>;
<span style="color:#228b22">/*
</span><span style="color:#228b22"> * 死锁的练习
</span><span style="color:#228b22"> */</span>
<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">DeadLock</span> {
	
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
		Runnable r1 =()-&gt;{
        	<span style="color:#8b008b;font-weight:bold">synchronized</span>(<span style="color:#cd5555">&#34;A&#34;</span>){
        		System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;A线程持有A锁，争抢B锁&#34;</span>);
        		<span style="color:#8b008b;font-weight:bold">synchronized</span>(<span style="color:#cd5555">&#34;B&#34;</span>){
	        		System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;A线程持有A锁和B锁&#34;</span>);
	        	}
        	
        	}
		};
		Runnable r2 =()-&gt;{
        	<span style="color:#8b008b;font-weight:bold">synchronized</span>(<span style="color:#cd5555">&#34;B&#34;</span>){
        		System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;B线程持有B锁，争抢A锁&#34;</span>);
        		<span style="color:#8b008b;font-weight:bold">synchronized</span>(<span style="color:#cd5555">&#34;A&#34;</span>){
	        		System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;B线程持有A锁和B锁&#34;</span>);
	        	}
        	
        	}
		};
		Thread t1 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1);
		Thread t2 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r2);
		t1.<span style="color:#658b00">start</span>();
		t2.<span style="color:#658b00">start</span>();
	}
}
</code></pre></div><h2 id="十三wait和notifynotifyall">十三、wait和notify、notifyAll</h2>
<p>wait:等待，是Object类中的一个方法，当前的CPU的释放自己的锁标记，并且让出CPU资源，是当前的线程进入等待队列。
notify:通知，是Object类中的一个方法，唤醒等待队列中的一个线程，是这个线程进入锁池。
notifyAll:通知，是Object类中的一个方法，唤醒等待队列中的所有线程，是这个线程进入锁池。</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">com.mntc.dead</span>;
<span style="color:#228b22">/*
</span><span style="color:#228b22"> * 死锁的练习
</span><span style="color:#228b22"> */</span>
<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">DeadLock</span> {
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
		Runnable r1 =()-&gt;{
        	<span style="color:#8b008b;font-weight:bold">synchronized</span>(<span style="color:#cd5555">&#34;A&#34;</span>){
        		System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;A线程持有A锁，争抢B锁&#34;</span>);
        		<span style="color:#8b008b;font-weight:bold">try</span> {
					<span style="color:#cd5555">&#34;A&#34;</span>.<span style="color:#658b00">wait</span>();
				} <span style="color:#8b008b;font-weight:bold">catch</span> (InterruptedException e) {
					<span style="color:#228b22">// TODO Auto-generated catch block
</span><span style="color:#228b22"></span>					e.<span style="color:#658b00">printStackTrace</span>();
				}
        		<span style="color:#8b008b;font-weight:bold">synchronized</span>(<span style="color:#cd5555">&#34;B&#34;</span>){
	        		System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;A线程持有A锁和B锁&#34;</span>);
	        	}
        	}
		};
		Runnable r2 =()-&gt;{
        	<span style="color:#8b008b;font-weight:bold">synchronized</span>(<span style="color:#cd5555">&#34;B&#34;</span>){
        		System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;B线程持有B锁，争抢A锁&#34;</span>);
        		<span style="color:#8b008b;font-weight:bold">synchronized</span>(<span style="color:#cd5555">&#34;A&#34;</span>){
	        		System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;B线程持有A锁和B锁&#34;</span>);
	        		<span style="color:#cd5555">&#34;A&#34;</span>.<span style="color:#658b00">notifyAll</span>();
	        	}
        	}
		};
		Thread t1 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r1);
		Thread t2 = <span style="color:#8b008b;font-weight:bold">new</span> Thread(r2);
		t1.<span style="color:#658b00">start</span>();
		t2.<span style="color:#658b00">start</span>();
	}
}
</code></pre></div><h2 id="十四设计模式">十四、设计模式</h2>
<p>1.多线程环境下的懒汉式设计模式
可能多个实例被同时创建。我们可以通过同步代码段来实现。
2.生产者与消费者设计模式
<code>生产者：</code></p>
<blockquote>
<p>1.作用是生产产品
2.生产逻辑：通过一个生产标记，判断是否需要生产产品
3.如果需要生产：生产产品，并通知消费者消费
4.如果不需要生产：等待
<code>消费者</code>
1.作用是消费产品
2.消费逻辑：判断是否有足够的产品可以消费
3.若果可以消费，则获取产品，进行消费
4.如果不可以消费：等待
代码实现：
消息的生产者：</p>
</blockquote>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">com.mntc.productorandconsumer</span>;

<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Productor</span> <span style="color:#8b008b;font-weight:bold">extends</span> Thread{
	<span style="color:#8b008b;font-weight:bold">private</span> ProductPool pool;
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#008b45">Productor</span>(ProductPool pool) {
		<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">pool</span> = pool;
	}

	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">run</span>() {
		<span style="color:#8b008b;font-weight:bold">while</span>(<span style="color:#8b008b;font-weight:bold">true</span>) {
			String name = (<span style="color:#00688b;font-weight:bold">int</span>)(Math.<span style="color:#658b00">random</span>() * 100)+ <span style="color:#cd5555">&#34;号产品&#34;</span>;
			System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;生产了一键产品&#34;</span>+name);
			Product product = <span style="color:#8b008b;font-weight:bold">new</span> Product(name);
			<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">pool</span>.<span style="color:#658b00">push</span>(product);
		}
	}
	
}
</code></pre></div><p>消息的消费者：</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">com.mntc.productorandconsumer</span>;

<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Consumer</span> <span style="color:#8b008b;font-weight:bold">extends</span> Thread{
	<span style="color:#8b008b;font-weight:bold">private</span> ProductPool pool;
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#008b45">Consumer</span>(ProductPool pool) {
		<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">pool</span> = pool;
	}
	
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">run</span>() {
		<span style="color:#8b008b;font-weight:bold">while</span>(<span style="color:#8b008b;font-weight:bold">true</span>) {
			Product product = <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">pool</span>.<span style="color:#658b00">pop</span>();
			System.<span style="color:#658b00">out</span>.<span style="color:#658b00">println</span>(<span style="color:#cd5555">&#34;消费者消费了一键产品&#34;</span>+product.<span style="color:#658b00">getName</span>());
		}
	}
}
</code></pre></div><p>产品对象：</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">com.mntc.productorandconsumer</span>;

<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Product</span> {
	<span style="color:#8b008b;font-weight:bold">private</span> String name;

	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#008b45">Product</span>(String name) {
		<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">name</span> = name;
	}

	<span style="color:#8b008b;font-weight:bold">public</span> String <span style="color:#008b45">getName</span>() {
		<span style="color:#8b008b;font-weight:bold">return</span> name;
	}

	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">setName</span>(String name) {
		<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">name</span> = name;
	}
	
}
</code></pre></div><p>存放商品的对象池：</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">com.mntc.productorandconsumer</span>;

<span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.util.LinkedList</span>;
<span style="color:#8b008b;font-weight:bold">import</span> <span style="color:#008b45;text-decoration:underline">java.util.List</span>;

<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">ProductPool</span> {
	<span style="color:#228b22">//存储产品的集合、生产者生产产品，往这个集合中添加元素，消费者消费产品，从这个集合中取出元素。
</span><span style="color:#228b22"></span>	<span style="color:#8b008b;font-weight:bold">private</span> List&lt;Product&gt; productList;
	<span style="color:#8b008b;font-weight:bold">private</span> <span style="color:#00688b;font-weight:bold">int</span> maxSize = 10;
	
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#008b45">ProductPool</span>(<span style="color:#00688b;font-weight:bold">int</span> maxSize) {
		<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">productList</span> = <span style="color:#8b008b;font-weight:bold">new</span> LinkedList&lt;Product&gt;();
		<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">maxSize</span> = maxSize;
	}
	
	<span style="color:#228b22">/*
</span><span style="color:#228b22">	 * 生产者将生产好的商品放入集合中
</span><span style="color:#228b22">	 */</span>
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">synchronized</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">push</span>(Product product) {
		<span style="color:#228b22">//将生产好的产品放入到集合中
</span><span style="color:#228b22"></span>		<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">productList</span>.<span style="color:#658b00">add</span>(product);
		<span style="color:#228b22">//通知其他的消费者可以消费了
</span><span style="color:#228b22"></span>		<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">notifyAll</span>();
		<span style="color:#228b22">//判断是否还需要在生产产品
</span><span style="color:#228b22"></span>		<span style="color:#8b008b;font-weight:bold">if</span>(<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">productList</span>.<span style="color:#658b00">size</span>() == <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">maxSize</span>) {
			<span style="color:#8b008b;font-weight:bold">try</span> {
				<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">wait</span>();
			} <span style="color:#8b008b;font-weight:bold">catch</span> (InterruptedException e) {
				<span style="color:#228b22">// TODO Auto-generated catch block
</span><span style="color:#228b22"></span>				e.<span style="color:#658b00">printStackTrace</span>();
			}
		}
	}
	
	
	<span style="color:#228b22">/*
</span><span style="color:#228b22">	 * 消费者从集合中取出产品
</span><span style="color:#228b22">	 */</span>
	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">synchronized</span> Product <span style="color:#008b45">pop</span>() {
		<span style="color:#8b008b;font-weight:bold">if</span>(<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">productList</span>.<span style="color:#658b00">size</span>() == 0) {
			<span style="color:#8b008b;font-weight:bold">try</span> {
				<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">wait</span>();
			} <span style="color:#8b008b;font-weight:bold">catch</span> (InterruptedException e) {
				<span style="color:#228b22">// TODO Auto-generated catch block
</span><span style="color:#228b22"></span>				e.<span style="color:#658b00">printStackTrace</span>();
			}
		}
		Product product = <span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">productList</span>.<span style="color:#658b00">remove</span>(0);
		<span style="color:#8b008b;font-weight:bold">this</span>.<span style="color:#658b00">notifyAll</span>();

		<span style="color:#8b008b;font-weight:bold">return</span> product;
	}
}
</code></pre></div><p>主控制程序：</p>
<div class="highlight"><pre style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#8b008b;font-weight:bold">package</span> <span style="color:#008b45;text-decoration:underline">com.mntc.productorandconsumer</span>;

<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">class</span> <span style="color:#008b45;font-weight:bold">Program</span> {

	<span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">static</span> <span style="color:#00688b;font-weight:bold">void</span> <span style="color:#008b45">main</span>(String[] args) {
		<span style="color:#228b22">// TODO Auto-generated method stub
</span><span style="color:#228b22"></span>		ProductPool pool = <span style="color:#8b008b;font-weight:bold">new</span> ProductPool(15);
		<span style="color:#228b22">//实例化一个生产者
</span><span style="color:#228b22"></span>		<span style="color:#8b008b;font-weight:bold">new</span> Productor(pool).<span style="color:#658b00">start</span>();
		<span style="color:#228b22">//实例化一个消费者
</span><span style="color:#228b22"></span>		<span style="color:#8b008b;font-weight:bold">new</span> Consumer(pool).<span style="color:#658b00">start</span>();
	}
}
</code></pre></div><p>注意的事项：</p>
<ul>
<li>创建线程的三种途径：</li>
<li>1.通过集成Thread类</li>
<li>2.通过实现Runnable接口</li>
<li>3.通过匿名内部类来实现（这种方法的本质和2下沟通）</li>
<li>通过继承和实现那种方法的比较好？</li>
<li>通过实现的途径比较好，因为java中使用的是单继承，所以说Thread只能被继承一次，但是Runnable接口可以被多次实现。</li>
<li>在public void run(){}方法中我们只能捕获异常</li>
</ul>

</article>
    </div>
</div>


                
<div id="sidebar" class="pure-u-1 pure-u-md-1-4 pure-u-sm-1">
    <div class="pad">
        <a name="about"></a>
        <h3>关于我</h3>
        <div style="text-align: center;">
            <img src="/img/author.jpg" alt="吴继文" class="pure-img" />
            <p><em>Handsome</em></p>
        </div>

        <h3>最近文章</h3>
        <div class="pure-menu pure-menu-open">
            <ul class="pure-menu-list">
                
                <li class="pure-menu-item">
                    <a href="https://example.com/posts/mybatis-plus/" class="pure-menu-link">Mybatis-Plus<br>
                        <small>MyBatis-Plus 的增强工具，在 MyBatis 的基础上只做增强不做改变，为简化开发、提高效率而生。</small>
                    </a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="https://example.com/posts/mongodb/" class="pure-menu-link">DBmong数据库<br>
                        <small>NoSQL 是一项全新的数据库革命性运动，早期就有人提出，发展至2009年趋势越发高涨。NoSQL的拥护者们提倡运用非关系型的数据存储，相对于铺天盖地的关系型数据库运用，这一概念无疑是一种全新的思维的注入。</small>
                    </a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="https://example.com/posts/docker/" class="pure-menu-link">Docker容器技术<br>
                        <small>这一种常用的容器技术，能简化项目的部署</small>
                    </a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="https://example.com/posts/go%E8%AF%AD%E8%A8%80/" class="pure-menu-link">Go语言技术知识<br>
                        <small>主要介绍GO语言的基本语法</small>
                    </a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="https://example.com/posts/hexo&#43;github%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2%E6%A1%86%E6%9E%B6/" class="pure-menu-link">hexo&#43;github搭建个人博客<br>
                        <small>介绍了个人博客搭建的完整步骤</small>
                    </a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="https://example.com/posts/idea%E7%9A%84%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/" class="pure-menu-link">IDEA的基本使用<br>
                        <small>主要介绍了IDEA的基本以用和一些常用的快捷键</small>
                    </a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="https://example.com/posts/java%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93/" class="pure-menu-link">Java原生代码连接数据库<br>
                        <small>介绍了在不使用框架的基础上连接MySQL</small>
                    </a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="https://example.com/posts/%E5%9F%BA%E4%BA%8Ejava%E7%9A%84%E5%A4%9A%E7%BA%BF%E7%A8%8B/" class="pure-menu-link">Java多线程基础知识<br>
                        <small>一种提高程序运行效率的技术</small>
                    </a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="https://example.com/posts/java%E5%AE%9E%E7%8E%B0%E4%B8%B2%E5%8F%A3%E9%80%9A%E4%BF%A1/" class="pure-menu-link">Java实现串口通信<br>
                        <small>Java实现窗口通信</small>
                    </a>
                </li>
                
                <li class="pure-menu-item">
                    <a href="https://example.com/posts/java%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86/" class="pure-menu-link">Java的基础知识<br>
                        <small>介绍了Java的基础知识</small>
                    </a>
                </li>
                
            </ul>
        </div>

        <h3>分类</h3>
        <div style="text-align:center" class="tags">
            
            
            <a href="/tags/%e6%a1%86%e6%9e%b6" class="pure-button"> 框架
                <small>(6)</small></a>
            
            
            
            <a href="/tags/%e7%bc%96%e7%a8%8b" class="pure-button"> 编程
                <small>(5)</small></a>
            
            
            
            <a href="/tags/%e5%85%b6%e5%ae%83" class="pure-button"> 其它
                <small>(2)</small></a>
            
            
            
            <a href="/tags/%e6%95%b0%e6%8d%ae%e5%ba%93" class="pure-button"> 数据库
                <small>(2)</small></a>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
        </div>
    </div> 
</div> 

                
            </div>
<div class="pure-g">
	<footer class="pure-u-1 pure-u-md-1 pure-u-sm-1">
		<p>This page and its contents are copyright &copy; 2020,
			<a href="">吴继文</a>.</p>
		<p><a href="https://github.com/pravin/hugo-theme-prav">Theme Prav</a> by <a href="https://cto.me.uk">Pravin
				Paratey</a></p>
	</footer>

	<script defer src="https://use.fontawesome.com/releases/v5.0.9/js/all.js"
		integrity="sha384-8iPTk2s/jMVj81dnzb/iFR2sdA7u06vHJyyLlAd4snFpCl/SnyUjRrbdJsw1pGIl"
		crossorigin="anonymous"></script>
</div>
</div></body>
</html>
